---
external help file: Microsoft.WindowsAzure.Commands.ServiceManagement.dll-Help.xml
ms.assetid: FDA81DCB-04A4-44E5-89CD-3C36F9BB6FA9
online version: ''
schema: 2.0.0
ms.openlocfilehash: 47ae6d45fd2043d394fa7884863a3235eaa0f8d5
ms.sourcegitcommit: 56ed085a868afa8263f8eb0f755b5822f5c29532
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/18/2020
ms.locfileid: "93967238"
---
# Set-AzureVMMicrosoftAntimalwareExtension

## 摘要
針對虛擬機器設定 Microsoft 反惡意程式碼擴充功能。

## 句法

### EnableMicrosoftAntimalwareExtensionJsonConfigFilePath (預設) 
```
Set-AzureVMMicrosoftAntimalwareExtension [-AntimalwareConfigFile] <String> [[-Version] <String>]
 [[-Monitoring] <String>] [[-StorageContext] <AzureStorageContext>] -VM <IPersistentVM>
 [-Profile <AzureSMProfile>] [-InformationAction <ActionPreference>] [-InformationVariable <String>]
 [<CommonParameters>]
```

### EnableMicrosoftAntimalwareExtensionJsonConfig
```
Set-AzureVMMicrosoftAntimalwareExtension [-AntimalwareConfiguration] <String> [[-Version] <String>]
 [[-Monitoring] <String>] [[-StorageContext] <AzureStorageContext>] -VM <IPersistentVM>
 [-Profile <AzureSMProfile>] [-InformationAction <ActionPreference>] [-InformationVariable <String>]
 [<CommonParameters>]
```

### DisableMicrosoftAntimalwareExtension
```
Set-AzureVMMicrosoftAntimalwareExtension [[-Version] <String>] [-Disable] -VM <IPersistentVM>
 [-Profile <AzureSMProfile>] [-InformationAction <ActionPreference>] [-InformationVariable <String>]
 [<CommonParameters>]
```

### UninstallMicrosoftAntimalwareExtension
```
Set-AzureVMMicrosoftAntimalwareExtension [-Uninstall] -VM <IPersistentVM> [-Profile <AzureSMProfile>]
 [-InformationAction <ActionPreference>] [-InformationVariable <String>] [<CommonParameters>]
```

### ConfigureMicrosoftAntimalwareMonitoring
```
Set-AzureVMMicrosoftAntimalwareExtension [-Monitoring] <String> [[-StorageContext] <AzureStorageContext>]
 [-NoConfig] -VM <IPersistentVM> [-Profile <AzureSMProfile>] [-InformationAction <ActionPreference>]
 [-InformationVariable <String>] [<CommonParameters>]
```

## 說明
AzureVMMicrosoftAntimalwareExtension Cmdlet 會 **設定** 虛擬機器的 Microsoft 反惡意程式碼延伸。
您可以啟用、停用或卸載延伸。

## 示例

### 範例1：使用設定檔啟用延伸
```
PS C:\> Get-AzureVM -ServiceName "ContosoService03" -Name "ContosoVM22" | Set-AzureVMMicrosoftAntimalwareExtension -AntimalwareConfigFile 'C:\configuration\contosoVM.json' | Update-AzureVM
```

這個命令會使用設定檔來啟用 Microsoft 反惡意程式碼擴充功能。
此命令使用 xxxxx **Cmdlet 來** 取得指定的虛擬電腦物件，然後使用管線運算子將物件傳遞至目前的 Cmdlet。

### 範例2：啟用延伸並啟用監視
```
PS C:\> $StorageContext = New-AzureStorageContext -StorageAccountName "contosostoragemain" -StorageAccountKey (Get-AzureStorageKey -StorageAccountName "Contosostoragemain").PrimaryP
S C:\> Get-AzureVM -ServiceName "ContosoService03" -Name"ContosoVM22" | Set-AzureVMMicrosoftAntimalwareExtension -AntimalwareConfigFile 'C:\configuration\contosoVM.json" -Monitoring ON -StorageContext $StorageContext | Update-AzureVM
```

第一個命令會使用 **新的-AzureStorageCoNtext** Cmdlet 建立 AzureStorageCoNtext 物件，然後將它儲存在 $StorageCoNtext 變數中。

### 範例3：透過指定 configuration 物件來啟用延伸功能
```
PS C:\> $Config_String = [IO.File]::ReadAllText('C:\configuration\contosoVM.json')
PS C:\> Get-AzureVM -ServiceName "ContosoService03" -Name "ContosoVM22" | Set-AzureVMMicrosoftAntimalwareExtension -AntimalwareConfiguration $Config_String | Update-AzureVM
```

第一個命令會透過讀取 Microsoft 反惡意程式碼延伸的 JSON 設定，然後將它儲存在 $config _string 變數中，來建立字串物件。

### 範例4：停用延伸
```
PS C:\> Get-AzureVM -ServiceName "ContosoService03" -Name "ContosoVM22" | Set-AzureVMMicrosoftAntimalwareExtension -Disable | Update-AzureVM
```

這個命令會停用副檔名，而不會將它移除。
此命令會使用 Get-AzureVM 來取得指定的虛擬機器物件，然後將物件傳遞至目前的 Cmdlet。

### 範例5：移除延伸
```
PS C:\> Get-AzureVM -ServiceName "ContosoService03" -Name"ContosoVM22" | Set-AzureVMMicrosoftAntimalwareExtension -Uninstall | Update-AzureVM
```

這個命令會從虛擬機器中移除 Microsoft 反惡意程式碼擴充功能。
此命令會使用 Get-AzureVM 來取得指定的虛擬機器物件，然後將物件傳遞至目前的 Cmdlet。

## 參數

### -AntimalwareConfigFile
指定 Microsoft 反惡意程式碼設定檔的絕對路徑。
如果您指定 AntimalwareConfiguration 參數，請勿指定此參數。
設定檔至少必須包含下列內容，才能啟用 Microsoft 反惡意程式碼延伸： 

`{ "AntimalwareEnabled": true }`

```yaml
Type: String
Parameter Sets: EnableMicrosoftAntimalwareExtensionJsonConfigFilePath
Aliases: 

Required: True
Position: 1
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### -AntimalwareConfiguration
指定包含 Microsoft 反惡意程式碼配置的字串物件。
這個物件不得 $Null 或空白。
如果您指定 AntimalwareConfigFile 參數，請勿指定此參數。
Configuration 物件至少必須包含下列內容，才能啟用 Microsoft 反惡意程式碼延伸： * * * * {"AntimalwareEnabled"： true}

Microsoft 反惡意程式碼 JSON 配置範例： 

{"AntimalwareEnabled"： true，"RealtimeProtectionEnabled"： true，"ScheduledScanSettings"： {"isEnabled"： true，"day"：1，"時間"：120，"scanType"： "Full"}，

"排除"： {"Extensions"： "ext1;。ext2 "，" 路徑 "：" c:\excluded-path-1; c:\excluded-path-2 "，" 進程 "：" excludedproc1.exe; excludedproc2.exe "}

}

注意： AntimalwareEnabled 是必要的參數。
值： true = Enable。
false = 錯誤為 false 不是受支援的值

RealtimeProtectionEnabled： true/false。 true = Enable。
false = 停用。
預設值為 true

ScheduledScanSettings:  
isEnabled = true/false day = 0-8 (0-日，1-星期日，2-星期一，...，7-星期六，8-已停用) 時間 = 0 (--60-1AM 之後，以分鐘為單位。 \> 120- \> 2AM，... ) scanType = "Quick" 或 "Full" (預設為 [快速) ] 注意：如果 isEnabled = true 是提供的唯一設定，則會設定下列預設值： day = 7 (星期六) ，時間 = 120 (2 AM) ，scanType = "快速" 排除：使用分號分隔符號指定了相同清單中的多個排除。

如果未指定任何排除，則現有的排除專案（如果有的話）會在系統上以空白覆寫。

```yaml
Type: String
Parameter Sets: EnableMicrosoftAntimalwareExtensionJsonConfig
Aliases: 

Required: True
Position: 1
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### -停用
表示 Cmdlet 停用 Microsoft 反惡意程式碼擴充功能。
若要在相同的虛擬機器上重新啟用延伸，請在沒有 Disable 參數的情況下執行 Set-AzureVMMicrosoftAntimalwareExtension。

```yaml
Type: SwitchParameter
Parameter Sets: DisableMicrosoftAntimalwareExtension
Aliases: 

Required: False
Position: 2
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### -InformationAction
指定這個 Cmdlet 回應資訊事件的方式。

此參數可接受的值為：

- 持續
- 理會
- 看
- SilentlyContinue
- 停止
- 封存

```yaml
Type: ActionPreference
Parameter Sets: (All)
Aliases: infa

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -InformationVariable
指定資訊變數。

```yaml
Type: String
Parameter Sets: (All)
Aliases: iv

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -監視
指定是否要收集 Microsoft 反惡意程式碼事件。

此參數可接受的值為：

- 按.
將 Microsoft 反惡意程式碼事件收集至儲存內容。 
- 出.
請勿收集 Microsoft 反惡意程式碼事件。

```yaml
Type: String
Parameter Sets: EnableMicrosoftAntimalwareExtensionJsonConfigFilePath, EnableMicrosoftAntimalwareExtensionJsonConfig
Aliases: 

Required: False
Position: 3
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

```yaml
Type: String
Parameter Sets: ConfigureMicrosoftAntimalwareMonitoring
Aliases: 

Required: True
Position: 3
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### -NoConfig
表示此 Cmdlet 指定 NoConfig 選項。

```yaml
Type: SwitchParameter
Parameter Sets: ConfigureMicrosoftAntimalwareMonitoring
Aliases: 

Required: True
Position: 3
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### -設定檔
指定此 Cmdlet 讀取的 Azure 設定檔。
如果您沒有指定設定檔，此 Cmdlet 會從本機預設設定檔讀取。

```yaml
Type: AzureSMProfile
Parameter Sets: (All)
Aliases: 

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -StorageCoNtext
指定 Microsoft 反惡意程式碼監視的 Azure 儲存區內容。

```yaml
Type: AzureStorageContext
Parameter Sets: EnableMicrosoftAntimalwareExtensionJsonConfigFilePath, EnableMicrosoftAntimalwareExtensionJsonConfig, ConfigureMicrosoftAntimalwareMonitoring
Aliases: 

Required: False
Position: 4
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### -卸載
表示此 Cmdlet 會從虛擬機器卸載 Microsoft 反惡意程式碼延伸。
如果已開啟監視，此 Cmdlet 也會移除 Microsoft 反惡意程式碼事件的集合。

```yaml
Type: SwitchParameter
Parameter Sets: UninstallMicrosoftAntimalwareExtension
Aliases: 

Required: True
Position: 1
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### -版本
將擴充版本指定為字串。 注意：支援的版本為1.5。 Microsoft 不支援較舊的版本。

```yaml
Type: String
Parameter Sets: EnableMicrosoftAntimalwareExtensionJsonConfigFilePath, EnableMicrosoftAntimalwareExtensionJsonConfig, DisableMicrosoftAntimalwareExtension
Aliases: 

Required: False
Position: 2
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### -VM
將虛擬機器指定為 IPersistentVM 物件。

```yaml
Type: IPersistentVM
Parameter Sets: (All)
Aliases: InputObject

Required: True
Position: Named
Default value: None
Accept pipeline input: True (ByPropertyName, ByValue)
Accept wildcard characters: False
```

### CommonParameters
這個 Cmdlet 支援通用參數：-Debug、-ErrorAction、-ErrorVariable、-InformationAction、-InformationVariable、-OutVariable、-OutBuffer、-PipelineVariable、-WarningAction、-WarningVariable、-、-、-、-、-、-。 如需詳細資訊，請參閱 about_CommonParameters (https://go.microsoft.com/fwlink/?LinkID=113216) 。

## 輸入

## 輸出

## 筆記

## 相關連結

[AzureVMMicrosoftAntimalwareExtension](./Get-AzureVMMicrosoftAntimalwareExtension.md)

[移除-AzureVMMicrosoftAntimalwareExtension](./Remove-AzureVMMicrosoftAntimalwareExtension.md)

[Add-azurevm](./Get-AzureVM.md)


